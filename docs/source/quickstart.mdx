---
title: Apollo Federation Quickstart
subtitle: Create a federated GraphQL API with Apollo Federation
description: Create a federated GraphQL API with Apollo Federation
---

By the end of this tutorial, you will have locally set up a federated GraphQL API using a demo supergraph.
To learn more about Apollo Federation and the benefits of using it with GraphOS, check out these resources:

- [Introduction to Apollo Federation](./)
- [Introduction to GraphOS](/graphos)

## Prerequisites

To complete this quickstart, you must have the following:

- A [GraphOS Studio](https://studio.apollographql.com/?referrer=docs-content) account
- An organization with an [Enterprise trial](https://studio.apollographql.com/signup?type=enterprise-trial&referrer=docs-content) or Enterprise plan
- A local version of the retail demo supergraphâ€”you can download or clone it from its [GitHub repository](https://github.com/apollosolutions/retail-supergraph)
- The latest LTS version of [Node](https://nodejs.org/en)

If you haven't already, set these up before continuing.

## Overview

Setting up a federated GraphQL API with GraphOS takes a few steps:

1. Install and authenticate the Rover CLI.
2. Start local development.
3. Query your supergraph.

### Step 1. Install and authenticate the Rover CLI

_Rover_ is Apollo's CLI for managing all kinds of graphs, including subgraphs and supergraphs. You'll use it throughout this quickstart.

<Note>

Even if you already have Rover installed, update your version by completing this step.

</Note>

Install the latest Rover release with the appropriate command for your system:

```bash title="MacOS / Unix-like" showLineNumbers=false
curl -sSL https://rover.apollo.dev/nix/latest | sh
```

```bash title="Windows" showLineNumbers=false
iwr 'https://rover.apollo.dev/win/latest' | iex
```

After installing, run `rover -V` in your terminal to confirm that it installed successfully.
Verify that the printed version number matches the [latest release](https://github.com/apollographql/rover/releases).
If it doesn't, you might need to manually delete a previous outdated installation.

To use the Rover CLI to manage graphs in GraphOS Studio, you first need to authenticate it.
This entails obtaining an API key and providing it to Rover.

<ObtainPersonalApiKey />

You can provide your API key to Rover either via the `config auth` command or by setting an environment variable.
The `config auth` command is intended for local development so it's appropriate for this tutorial. Run the command:

```shell showLineNumbers=false
rover config auth
```

Then copy your personal API key into the prompt when requested.

<Note>

The `auth` command is interactive to prevent your API key from appearing in your terminal command history.

</Note>

### Step 2. Start local development

To start local development, you first need to get the retail demo supergraph up and running.
From the root directory, install dependencies:

```bash
npm install
```

Then run the subgraphs:

```bash
npm run dev:subgraphs
```

Now you can use Rover to start the supergraph locally.
Specifically, the `rover dev` command starts the supergraph's router.
You can use the `dev` command with the `--supergraph-config` option to provide the router's configuration.
The `retail-supergraph.yaml` is a [YAML configuration file](/rover/commands/dev#starting-a-session-with-multiple-subgraphs) that includes subgraph names, URLs, and schemas for the retail demo supergraph.

In a separate terminal window, run this command:

```bash title="Example configuration command" showLineNumbers=false
rover dev --supergraph-config supergraph-config-dev.yaml
```

When you first start the `rover dev` process, you'll see the following in the terminal:

1. Rover obtains the provided subgraph schemas and starts sessions for each of them.
2. Rover uses Apollo Federation to compose a supergraph schema from the subgraph schemas.
3. Rover starts a locally running router session and provides it with the supergraph schema.
4. Rover starts watching the provided subgraph schema for changes. It recomposes the supergraph schema whenever it detects one. Recomposition automatically reloads the router.

To ensure everything is working as expected, you can try querying your router in the Apollo Sandbox that Rover automatically starts up.
Specifically, you can try searching for all products that start with "A".

1. Open [localhost:4000](http://localhost:4000/). This lets you explore the composed schema in Apollo Sandbox.

[To-do: Sandbox image]

2. Copy and paste the following query into the **Operation** window:

```graphQL showLineNumbers=false
# Search all products with some optional filters
query SearchProducts($searchInput: ProductSearchInput!) {
  searchProducts(searchInput: $searchInput) {
    id
    title
    description
    mediaUrl
    variants {
      id
      price
    }
  }
}
```

3. In the **Variables** tab below the **Operation** window, past the following JSON:

```JSON showLineNumbers=false
{
  "searchInput": {
    "titleStartsWith": "A"
  }
}
```
4. Click the play button, now labeled with the name of the sample operation, **SearchProducts**.

You should see a response that looks like this:

```JSON showLineNumbers=false
{
  "data": {
    "searchProducts": [
      {
        "id": "product:1",
        "title": "Air Jordan 1 Mid",
        "description": "Air Jordan 1 Mid is a blue, grey and white sneaker from the iconic jordan brand",
        "mediaUrl": "https://sneakernews.com/wp-content/uploads/2022/06/air-jordan-1-mid-university-blue-grey-dx9276-100-6.jpg",
        "variants": [
          {
            "id": "variant:1",
            "price": 600.25
          },
          {
            "id": "variant:2",
            "price": 20.12
          }
        ]
      },
      ...
    ]
  }
}
```

Congrats, you've built and queried a federated GraphQL API locally!
Next, you'll query your supergraph using the GraphOS Studio Explorer which offers additional capabilities over Apollo Sandbox.

<Note>

You can stop your initial `rover dev` process by pressing `CTRL+C`. This shuts down the local router session and any secondary `rover dev` processes attached to that same session.

</Note>


### Step 3. Query your supergraph

The Explorer is a GraphQL IDE that provides visibility into your supergraph's entire schema and helps you build, run, and understand queries.

In [GraphOS Studio](https://studio.apollographql.com/?referrer=docs-content), from your organization's **Graphs** tab, select your new variant and then open its **Explorer** page from the left navigation.

Run the query you previously ran in the Sandbox:

```graphQL showLineNumbers=false
query ExampleQuery {
  todo
}
```

Querying in Explorer may not feel that different from running the query in the Sandbox. Running operations on a published supergraph from the Explorer has a couple of additional benefits:

- Inspecting query plans
- Collecting and visualizing operation metrics

#### Inspect query plans

The Explorer dynamically displays example _query plans_ for your operations in the right-hand panel.
A query plan is a blueprint for dividing a single incoming operation into one or more operations that are each resolvable by a single subgraph.
You can toggle to view the query plan instead of the response by clicking **Response** and selecting **Query Plan Preview**.

[To-do: QP image]

An example query plan for the query you previously ran may look something like this:

```showLineNumbers=false
QueryPlan {
  Parallel {
    Fetch(service: "products") {
      {
        products {
          id
          name
        }
      }
    },
    Fetch(service: "orders") {
      {
        latestOrders {
          id
        }
      }
    },
  },
}
```

As you edit an operation, the Explorer recalculates its example query plan accordingly.
Query plans to help you understand the inner workings of Apollo Federation.

#### Collect and visualize metrics

Operations you run in the Explorer are sent to the GraphOS Router that sits in front of your federated API.
The router automatically collects metrics on those operations and their fields. You can then visualize those metrics in Studio.

Go to your variant's **Insights** page, which looks like this:

<img
  src="./images/insights-quickstart.jpg"
  className="screenshot"
  width="700"
  alt="The Insights page in GraphOS Studio, showing metrics for operations and their fields"
/>

The **Insights** page should already display the operations you executed in the Explorer.
After you update your clients to query your router, this page becomes vital to monitoring your supergraph's performance.

## Next steps

Depending on your goals, you have several options for moving your supergraph closer to production or learning more about GraphOS Studio's capabilities:

- [Publish](/graphos/delivery/publishing-schemas/) your locally running supergraph to GraphOS Studio and [share it with your team](/graphos/org/members#inviting-members).
- Learn about the available GraphOS insights in the [metrics and reporting documentation](/graphos/metrics).
- Explore other Studio features, including [schema visualization](/graphos/graphs/studio-features#the-schema-page), [proposals](/graphos/delivery/schema-proposals), and [checks](/graphos/delivery/schema-checks).
- Check out the [`rover template`](/rover/commands/template) command to quickly start a new GraphQL project or explore various subgraph implementations.